{"version":3,"sources":["plugin.js"],"names":["tinymce","PluginManager","add","editor","setLanguageState","parent_node","dom","getParent","selection","getNode","codeSelect","disabled","value","getAttrib","codeControl","setLanguage","lang","console","log","setAttrib","setLineNumber","line_number","openControlPanel","lang_value","line_value","line_enabled","windowManager","open","title","wprainbow","l10n","code_properties","body","type","name","size","label","code_language","values","languages","line_numbers","checked","starting_line","onsubmit","e","data","language","line","enable_line_numbering","Math","abs","isNaN","addButton","text","tooltip","menu_button","classes","onselect","this","onPostRender","on","event","i","contentStyles","push","onclick"],"mappings":"AAAAA,QAAQC,cAAcC,IAAK,YAAc,SAAUC,GAGlD,QAASC,KACR,GAAIC,GAAcF,EAAOG,IAAIC,UAAWJ,EAAOK,UAAUC,UAAW,MAEpEC,GAAWC,UAAYN,GACvBK,EAAWE,MAAMT,EAAOG,IAAIO,UAAWR,EAAa,kBAE5CS,GACPA,EAAYH,UAAYN,GAI1B,QAASU,GAAaC,GACrBC,QAAQC,IAAIF,GACZb,EAAOG,IAAIa,UACVhB,EAAOG,IAAIC,UAAWJ,EAAOK,UAAUC,UAAW,OAClD,gBACAO,GAGF,QAASI,GAAeC,GACvBlB,EAAOG,IAAIa,UACVhB,EAAOG,IAAIC,UAAWJ,EAAOK,UAAUC,UAAW,OAClD,YACAY,GAIF,QAASC,KACR,GAAIjB,GAAcF,EAAOG,IAAIC,UAAWJ,EAAOK,UAAUC,UAAW,OACnEc,EAAapB,EAAOG,IAAIO,UAAWR,EAAa,iBAChDmB,EAAarB,EAAOG,IAAIO,UAAWR,EAAa,cAAiB,EACjEoB,EAA6B,MAAdD,CAEhBrB,GAAOuB,cAAcC,MACpBC,MAAOC,UAAUC,KAAKC,gBACtBC,OAEGC,KAAM,UACNC,KAAM,WACNC,KAAM,GACNC,MAAOP,UAAUC,KAAKO,cACtBC,OAAQT,UAAUU,UAClB3B,MAAOW,IAGPU,KAAK,WACLC,KAAK,wBACLE,MAAOP,UAAUC,KAAKU,aACtB5B,MAAO,IACP6B,QAAShB,IAGTQ,KAAK,UACLC,KAAK,gBACLE,MAAOP,UAAUC,KAAKY,cACtB9B,MAAOY,IAGVmB,SAAU,SAASC,GAElB7B,EAAa6B,EAAEC,KAAKC,UACpB7B,QAAQC,KAER,IAAI6B,IAAQ,CACRH,GAAEC,KAAKG,wBACVD,EAAOE,KAAKC,IAAIN,EAAEC,KAAKH,eAClBS,MAAOJ,KACXA,EAAO,IAGT3B,EAAe2B,MAxElB,GAAIrC,GAAYI,CA6EhBX,GAAOiD,UAAU,aAChBnB,KAAM,UACNoB,KAAMxB,UAAUC,KAAKO,cACrBiB,QAASzB,UAAUC,KAAKO,cACxBkB,aAAc,EACdC,QAAU,yBACVC,SAAU,SAASb,GAClB7B,EAAa2C,KAAK9C,UAEnB0B,OAAQT,UAAUU,UAClBoB,aAAc,WACbjD,EAAagD,KACbvD,EAAOyD,GAAI,aAAc,SAAUC,GAClCzD,KAED,KAAM,GAAI0D,KAAKjC,WAAUU,UAAY,CACpC,GAAIvB,GAAOa,UAAUU,UAAUuB,GAAGlD,KAC1BI,IACPb,EAAO4D,cAAcC,KAAM,sBAAsBhD,EAAK,wBAAwBa,UAAUU,UAAUuB,GAAGT,KAAK,WAO9GlD,EAAOiD,UAAU,yBAChBE,QAASzB,UAAUC,KAAKC,gBACxBkC,QAAS3C,EACTqC,aAAc,WACb7C,EAAc4C,KACdvD,EAAOyD,GAAI,aAAc,SAAUC,GAClCzD","file":"plugin.js","sourcesContent":["tinymce.PluginManager.add( 'wprainbow' , function( editor ){\n\tvar codeSelect, codeControl;\n\t\n\tfunction setLanguageState( ) {\n\t\tvar parent_node = editor.dom.getParent( editor.selection.getNode() ,'PRE');\n\n\t\tcodeSelect.disabled( ! parent_node );\n\t\tcodeSelect.value(editor.dom.getAttrib( parent_node, 'data-language' ));\n\n\t\tif ( !! codeControl ) {\n\t\t\tcodeControl.disabled( ! parent_node );\n\t\t}\n\t}\n\n\tfunction setLanguage( lang ) {\n\t\tconsole.log(lang);\n\t\teditor.dom.setAttrib( \n\t\t\teditor.dom.getParent( editor.selection.getNode() ,'PRE') , \n\t\t\t'data-language' , \n\t\t\tlang\n\t\t);\n\t}\n\tfunction setLineNumber( line_number ) {\n\t\teditor.dom.setAttrib( \n\t\t\teditor.dom.getParent( editor.selection.getNode() ,'PRE') , \n\t\t\t'data-line' , \n\t\t\tline_number\n\t\t);\n\t}\n\n\tfunction openControlPanel() {\n\t\tvar parent_node = editor.dom.getParent( editor.selection.getNode() ,'PRE'),\n\t\t\tlang_value = editor.dom.getAttrib( parent_node, 'data-language' ),\n\t\t\tline_value = editor.dom.getAttrib( parent_node, 'data-line' ) || 0,\n\t\t\tline_enabled = line_value != \"-1\";\n\n\t\teditor.windowManager.open({\n\t\t\ttitle: wprainbow.l10n.code_properties,\n\t\t\tbody: [\n\t\t\t\t\t{\t\n\t\t\t\t\t\ttype: 'listbox', \n\t\t\t\t\t\tname: 'language', \n\t\t\t\t\t\tsize: 40, \n\t\t\t\t\t\tlabel: wprainbow.l10n.code_language, \n\t\t\t\t\t\tvalues: wprainbow.languages,\n\t\t\t\t\t\tvalue: lang_value \n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttype:'checkbox',\n\t\t\t\t\t\tname:'enable_line_numbering',\n\t\t\t\t\t\tlabel: wprainbow.l10n.line_numbers, \n\t\t\t\t\t\tvalue: \"1\",\n\t\t\t\t\t\tchecked: line_enabled\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttype:'textbox',\n\t\t\t\t\t\tname:'starting_line',\n\t\t\t\t\t\tlabel: wprainbow.l10n.starting_line, \n\t\t\t\t\t\tvalue: line_value\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\tonsubmit: function(e) {\n\t\t\t\t// set language\n\t\t\t\tsetLanguage( e.data.language );\n\t\t\t\tconsole.log();\n\t\t\t\t\n\t\t\t\tvar line = -1;\n\t\t\t\tif (e.data.enable_line_numbering) {\n\t\t\t\t\tline = Math.abs(e.data.starting_line);\n\t\t\t\t\tif ( isNaN( line ) )\n\t\t\t\t\t\tline = 1;\n\t\t\t\t}\n\t\t\t\t// set or del line number\n\t\t\t\tsetLineNumber( line );\n\t\t\t}\n\t\t});\n\t}\n\t\n\teditor.addButton('wprainbow', {\n\t\ttype: 'listbox',\n\t\ttext: wprainbow.l10n.code_language,\n\t\ttooltip: wprainbow.l10n.code_language,\n\t\tmenu_button : true,\n\t\tclasses : 'widget btn fixed-width', \n\t\tonselect: function(e) {\n\t\t\tsetLanguage( this.value() );\n\t\t},\n\t\tvalues: wprainbow.languages,\n\t\tonPostRender: function() {\n\t\t\tcodeSelect = this;\n\t\t\teditor.on( 'nodechange', function( event ) {\n\t\t\t\tsetLanguageState( );\n\t\t\t});\n\t\t\tfor ( var i in wprainbow.languages ) {\n\t\t\t\tvar lang = wprainbow.languages[i].value;\n\t\t\t\tif ( !! lang ) {\n\t\t\t\t\teditor.contentStyles.push( 'pre[data-language=\"'+lang+'\"]:before { content:\"'+wprainbow.languages[i].text+'\" }' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t});\n\n\teditor.addButton('wprainbow_codecontrol', {\n\t\ttooltip: wprainbow.l10n.code_properties,\n\t\tonclick: openControlPanel,\n\t\tonPostRender: function() {\n\t\t\tcodeControl = this;\n\t\t\teditor.on( 'nodechange', function( event ) {\n\t\t\t\tsetLanguageState( );\n\t\t\t});\n\t\t}\n\t});\n\t\n} );\n"]}