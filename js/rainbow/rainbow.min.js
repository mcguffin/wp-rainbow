!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Rainbow=t()}(this,function(){"use strict";function e(){return"undefined"!=typeof module&&"object"==typeof module.exports}function t(e){var t=e.getAttribute("data-language")||e.parentNode.getAttribute("data-language");if(!t){var n=/\blang(?:uage)?-(\w+)/,r=e.className.match(n)||e.parentNode.className.match(n);r&&(t=r[1])}return t?t.toLowerCase():null}function n(e,t,n,r){return(n!==e||r!==t)&&(n<=e&&r>=t)}function r(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&(?![\w\#]+;)/g,"&amp;")}function a(e,t){for(var n=0,r=1;r<t;++r)e[r]&&(n+=e[r].length);return n}function o(e,t,n,r){return n>=e&&n<t||r>e&&r<t}function i(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t.sort(function(e,t){return t-e})}function u(e,t,n,r){var a=r.substr(e);return r.substr(0,e)+a.replace(t,n)}function s(t,Prism){if(e())return global.Worker=require("webworker-threads").Worker,new Worker(__filename);var s=Prism.toString(),c=i.toString();c+=r.toString(),c+=n.toString(),c+=o.toString(),c+=u.toString(),c+=a.toString(),c+=s;var f=c+"\tthis.onmessage="+t.toString(),l=new Blob([f],{type:"text/javascript"});return new Worker((window.URL||window.webkitURL).createObjectURL(l))}function c(e){function t(){self.postMessage({id:n.id,lang:n.lang,result:a})}var n=e.data,r=new Prism(n.options),a=r.refract(n.code,n.lang);if(n.isNode)return t(),void self.close();setTimeout(function(){t()},1e3*n.options.delay)}function f(){return(A||null===k)&&(k=s(c,Prism)),k}function l(e,t){function n(a){a.data.id===e.id&&(t(a.data),r.removeEventListener("message",n))}var r=f();r.addEventListener("message",n),r.postMessage(e)}function d(e,t,n){return function(r){e.innerHTML=r.result,e.classList.remove("loading"),"PRE"===e.parentNode.tagName&&e.parentNode.classList.remove("loading"),E&&E(e,r.lang),0==--t.c&&n()}}function g(e){return{patterns:M,inheritenceMap:C,aliases:S,globalClass:e.globalClass,delay:isNaN(e.delay)?0:e.delay}}function m(e,t){var n={};return"object"==typeof t&&(n=t,t=n.language),t=S[t]||t,{id:x++,code:e,lang:t,options:g(n),isNode:A}}function p(e,n){for(var r={c:0},a=0,o=e;a<o.length;a+=1){var i=o[a],u=t(i);if(!i.classList.contains("rainbow")&&u){i.classList.add("loading"),i.classList.add("rainbow"),"PRE"===i.parentNode.tagName&&i.parentNode.classList.add("loading");var s=i.getAttribute("data-global-class"),c=parseInt(i.getAttribute("data-delay"),10);++r.c,l(m(i.innerHTML,{language:u,globalClass:s,delay:c}),d(i,r,n))}}0===r.c&&n()}function v(e){var t=document.createElement("div");t.className="preloader";for(var n=0;n<7;n++)t.appendChild(document.createElement("div"));e.appendChild(t)}function h(e,t){t=t||function(){},e=e&&"function"==typeof e.getElementsByTagName?e:document;for(var n=e.getElementsByTagName("pre"),r=e.getElementsByTagName("code"),a=[],o=[],i=0,u=n;i<u.length;i+=1){var s=u[i];v(s),s.getElementsByTagName("code").length?s.getAttribute("data-trimmed")||(s.setAttribute("data-trimmed",!0),s.innerHTML=s.innerHTML.trim()):a.push(s)}for(var c=0,f=r;c<f.length;c+=1){var l=f[c];o.push(l)}p(o.concat(a),t)}function b(e){E=e}function y(e,t,n){C[e]||(C[e]=n),M[e]=t.concat(M[e]||[])}function w(e){delete C[e],delete M[e]}function N(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if("string"==typeof e[0]){return void l(m(e[0],e[1]),function(e){return function(t){e&&e(t.result,t.lang)}}(e[2]))}if("function"==typeof e[0])return void h(0,e[0]);h(e[0],e[1])}function L(e,t){S[e]=t}var E,Prism=function Prism(e){function t(e,t){for(var r in h)if(r=parseInt(r,10),n(r,h[r],e,t)&&(delete h[r],delete v[r]),o(r,h[r],e,t))return!0;return!1}function s(t,n){var r=t.replace(/\./g," "),a=e.globalClass;return a&&(r+=" "+a),'<span class="'+r+'">'+n+"</span>"}function c(e){for(var t=i(v),n=0,r=t;n<r.length;n+=1){var a=r[n],o=v[a];e=u(a,o.replace,o.with,e)}return e}function f(e){var t="";return e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),new RegExp(e.source,t)}function l(n,r,o){void 0===o&&(o=0);var c=n.pattern;if(!c)return!1;var l=!c.global;c=f(c);var d=c.exec(r);if(!d)return!1;!n.name&&n.matches&&"string"==typeof n.matches[0]&&(n.name=n.matches[0],delete n.matches[0]);var g=d[0],m=d.index+o,b=d[0].length+m;if(m===b)return!1;if(t(m,b))return{remaining:r.substr(b-o),offset:b};for(var y=i(n.matches),w=0,N=y;w<N.length;w+=1){var L=N[w];!function(t){var r=d[t];if(r){var o=n.matches[t],i=o.language,c=o.name&&o.matches?o.matches:o,f=function(e,n,r){g=u(a(d,t),e,r?s(r,n):n,g)};if("string"==typeof o)return void f(r,r,o);var l,m=new Prism(e);if(i)return l=m.refract(r,i),void f(r,l);l=m.refract(r,p,c.length?c:[c]),f(r,l,o.matches?o.name:0)}}(L)}return function(e){return n.name&&(e=s(n.name,e)),v[m]={replace:d[0],with:e},h[m]=b,!l&&{remaining:r.substr(b-o),offset:b}}(g)}function d(e,t){for(var n=0,r=t;n<r.length;n+=1)for(var a=r[n],o=l(a,e);o;)o=l(a,o.remaining,o.offset);return c(e)}function g(t){for(var n=e.patterns[t]||[];e.inheritenceMap[t];)t=e.inheritenceMap[t],n=n.concat(e.patterns[t]||[]);return n}function m(e,t,n){return p=t,n=n||g(t),d(r(e),n)}var p,v={},h={};this.refract=m},M={},C={},S={},T={},x=0,A=e(),R=function(){return"undefined"==typeof document&&"undefined"!=typeof self}(),k=null;return T={extend:y,remove:w,onHighlight:b,addAlias:L,color:N},A&&(T.colorSync=function(e,t){var n=m(e,t);return new Prism(n.options).refract(n.code,n.lang)}),A||R||document.addEventListener("DOMContentLoaded",function(e){T.defer||T.color(e)},!1),R&&(self.onmessage=c),T});